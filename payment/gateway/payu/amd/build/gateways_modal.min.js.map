{"version":3,"file":"gateways_modal.min.js","sources":["../src/gateways_modal.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * This module handles PayU content in the gateways modal.\r\n *\r\n * @module     paygw_payu/gateways_modal\r\n * @copyright  2024 Orion Cloud Consulting SAS\r\n * @author     Alonso Arias <soporte@orioncloud.com.co>\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\ndefine(['core/templates', 'core/modal'], function(Templates, Modal) {\r\n    'use strict';\r\n    \r\n    /**\r\n     * Process payment gateway selection.\r\n     *\r\n     * @param {String} component\r\n     * @param {String} paymentArea\r\n     * @param {String} itemId\r\n     * @param {String} description\r\n     * @returns {Promise}\r\n     */\r\n    const process = function(component, paymentArea, itemId, description) {\r\n        return showModalWithPlaceholder()\r\n            .then(function() {\r\n                // Redirect to method selection page.\r\n                location.href = M.cfg.wwwroot + '/payment/gateway/payu/method.php?' +\r\n                    'sesskey=' + M.cfg.sesskey +\r\n                    '&component=' + component +\r\n                    '&paymentarea=' + paymentArea +\r\n                    '&itemid=' + itemId +\r\n                    '&description=' + encodeURIComponent(description);\r\n                \r\n                return new Promise(function() {\r\n                    // Keep promise pending to prevent modal closing.\r\n                });\r\n            });\r\n    };\r\n    \r\n    /**\r\n     * Show modal with PayU placeholder.\r\n     *\r\n     * @returns {Promise}\r\n     */\r\n    const showModalWithPlaceholder = async function() {\r\n        const modal = await Modal.create({\r\n            body: await Templates.render('paygw_payu/button_placeholder', {}),\r\n            show: true,\r\n            removeOnClose: true,\r\n        });\r\n        \r\n        setTimeout(function() {\r\n            modal.destroy();\r\n        }, 100);\r\n        \r\n        return Promise.resolve();\r\n    };\r\n    \r\n    return {\r\n        process: process\r\n    };\r\n});"],"names":["define","Templates","Modal","showModalWithPlaceholder","async","modal","create","body","render","show","removeOnClose","setTimeout","destroy","Promise","resolve","process","component","paymentArea","itemId","description","then","location","href","M","cfg","wwwroot","sesskey","encodeURIComponent"],"mappings":";;;;;;;;AAwBAA,mCAAO,CAAC,iBAAkB,eAAe,SAASC,UAAWC,aAkCnDC,yBAA2BC,uBACvBC,YAAcH,MAAMI,OAAO,CAC7BC,WAAYN,UAAUO,OAAO,gCAAiC,IAC9DC,MAAM,EACNC,eAAe,WAGnBC,YAAW,WACPN,MAAMO,YACP,KAEIC,QAAQC,iBAGZ,CACHC,QArCY,SAASC,UAAWC,YAAaC,OAAQC,oBAC9ChB,2BACFiB,MAAK,kBAEFC,SAASC,KAAOC,EAAEC,IAAIC,QAANF,4CACCA,EAAEC,IAAIE,QACnB,cAAgBV,UAChB,gBAAkBC,YAClB,WAAaC,OACb,gBAAkBS,mBAAmBR,aAElC,IAAIN,SAAQ"}