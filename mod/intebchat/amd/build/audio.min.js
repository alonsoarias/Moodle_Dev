/**
 * Audio recording utilities extracted from local_geniai plugin.
 *
 * @module     mod_intebchat/audio
 * @copyright  2024 Eduardo Kraus
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_intebchat/audio",["jquery"],(function($){return{init:function(mode){var chunks=[],mediaRecorder=null,audioMode=mode||"text";function reset(){$("#intebchat-icon-mic").removeClass("recording").show(),$("#intebchat-icon-stop").hide(),$("#intebchat-recorded-audio").val("")}$("#intebchat-icon-mic").on("click",(function(){reset(),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(stream){(mediaRecorder=new MediaRecorder(stream)).start(),$("#intebchat-icon-mic").addClass("recording").hide(),$("#intebchat-icon-stop").show(),mediaRecorder.ondataavailable=function(e){chunks.push(e.data)},mediaRecorder.onstop=function(){var reader=new FileReader;reader.readAsDataURL(new Blob(chunks,{type:"audio/mp3"})),reader.onloadend=function(){$("#intebchat-recorded-audio").val(reader.result),"audio"!==audioMode&&"both"!==audioMode||$("#intebchat-icon-stop").trigger("audio-ready")},chunks=[]}})).catch((function(err){alert(err),reset()})):alert("Your browser does not support recording!")})),$("#intebchat-icon-stop").on("click",(function(){mediaRecorder&&(mediaRecorder.stop(),mediaRecorder=null),$("#intebchat-icon-mic").show().removeClass("recording"),$("#intebchat-icon-stop").hide()}))}}}));

//# sourceMappingURL=audio.min.js.map