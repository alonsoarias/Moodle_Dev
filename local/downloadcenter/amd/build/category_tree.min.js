/**
 * Category tree navigation for download center
 *
 * @module     local_downloadcenter/category_tree
 * @copyright  2025 Alonso Arias <soporte@ingeweb.co>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_downloadcenter/category_tree",["core/ajax","core/templates","core/notification"],(function(Ajax,Templates,Notification){const CategoryTree=function(){this.init()};return CategoryTree.prototype.init=function(){const self=this;document.addEventListener("click",(function(e){if(e.target.classList.contains("category-expand")){e.preventDefault();const expandBtn=e.target,categoryid=expandBtn.dataset.categoryid,container=expandBtn.closest(".category-node").querySelector(".category-courses");if(container){container.classList.contains("loaded")?"none"!==container.style.display&&container.style.display?container.style.display="none":container.style.display="block":self.loadCategoryCourses(categoryid,container);const icon=expandBtn.querySelector("i");icon&&(icon.classList.toggle("fa-plus"),icon.classList.toggle("fa-minus"))}}})),document.addEventListener("change",(function(e){if(e.target.classList.contains("category-checkbox")){const checkbox=e.target,checked=checkbox.checked,categoryNode=checkbox.closest(".category-node");categoryNode&&(categoryNode.querySelectorAll(".course-checkbox").forEach((function(cb){cb.checked=checked;const event=new Event("change",{bubbles:!0});cb.dispatchEvent(event)})),categoryNode.querySelectorAll(".category-checkbox").forEach((function(cb){cb!==checkbox&&(cb.checked=checked)})))}})),this.updateTriStateCheckboxes()},CategoryTree.prototype.loadCategoryCourses=function(categoryid,container){Ajax.call([{methodname:"local_downloadcenter_get_category_courses",args:{categoryid:categoryid},done:function(response){Templates.render("local_downloadcenter/course_list",response).then((function(html){container.innerHTML=html,container.classList.add("loaded"),container.style.display="block"}))},fail:function(error){Notification.exception(error)}}])},CategoryTree.prototype.updateTriStateCheckboxes=function(){document.querySelectorAll(".category-node").forEach((function(node){const checkbox=node.querySelector(".category-checkbox");if(!checkbox)return;const courses=node.querySelectorAll(".course-checkbox");if(0===courses.length)return;const total=courses.length;let checked=0;courses.forEach((function(cb){cb.checked&&checked++})),0===checked?(checkbox.checked=!1,checkbox.indeterminate=!1):checked===total?(checkbox.checked=!0,checkbox.indeterminate=!1):(checkbox.checked=!1,checkbox.indeterminate=!0)}))},{init:function(){return new CategoryTree}}}));

//# sourceMappingURL=category_tree.min.js.map