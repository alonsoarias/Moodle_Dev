/**
 * Search functionality for download center
 *
 * @module     local_downloadcenter/search
 * @copyright  2025 Original: Academic Moodle Cooperation
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_downloadcenter/search",[],(function(){const IDENTIFIERS_SEARCHINPUT="downloadcenter-search-input",IDENTIFIERS_FORM="#region-main form.mform",IDENTIFIERS_FORMELEMENTS=".fitem",IDENTIFIERS_TOPICS=".card.block",IDENTIFIERS_CHECKBOX='input[type="checkbox"]',IDENTIFIERS_TITLE="label .itemtitle span:not(.badge)",IDENTIFIERS_RESULTSHOLDER="downloadcenter-search-results",IDENTIFIERS_RESULTSCOUNT="downloadcenter-search-results-count",IDENTIFIERS_SEARCHCLEAR="#downloadcenter-search-clear",allCmsPerTopic=[];let resultsHolder=null,resultsCount=null,searchClearBtn=null,searchInput=null;const search=function(searchValue){const showAll=0===searchValue.length;let resultscount=0;allCmsPerTopic.forEach((topic=>{let foundInTopic=!1;topic.cms.forEach((cm=>{cm.title.indexOf(searchValue)>-1||showAll?(foundInTopic=!0,resultscount++,cm.visible=!0,cm.elem.classList.remove("d-none")):(cm.visible=!1,cm.elem.classList.add("d-none"))})),foundInTopic?(topic.visible=!0,topic.elem.classList.remove("d-none")):(topic.visible=!1,topic.elem.classList.add("d-none"))})),showAll?(resultsHolder.classList.add("d-none"),searchClearBtn.classList.add("d-none")):(resultsCount.textContent=resultscount,resultsHolder.classList.remove("d-none"),searchClearBtn.classList.remove("d-none"))},searchClear=function(e){e.preventDefault(),searchInput.value="",search("")},submitForm=function(){return allCmsPerTopic.forEach((topic=>{!topic.visible&&topic.checkbox.checked&&(topic.checkbox.checked=!1),topic.cms.forEach((cm=>{!cm.visible&&cm.checkbox.checked&&(cm.checkbox.checked=!1)}))})),!0};return{init:function(){if(searchInput=document.getElementById(IDENTIFIERS_SEARCHINPUT),!searchInput)return;searchInput.addEventListener("input",(function(e){search(e.target.value.toLowerCase())}));const form=document.querySelector(IDENTIFIERS_FORM);if(!form)return;const topics=form.querySelectorAll(IDENTIFIERS_TOPICS);resultsHolder=document.getElementById(IDENTIFIERS_RESULTSHOLDER),resultsCount=document.getElementById(IDENTIFIERS_RESULTSCOUNT),searchClearBtn=document.querySelector(IDENTIFIERS_SEARCHCLEAR),searchClearBtn&&searchClearBtn.addEventListener("click",searchClear),form.addEventListener("submit",submitForm),topics.forEach((topic=>{const elements=topic.querySelectorAll(IDENTIFIERS_FORMELEMENTS),topicObj={elem:topic,cms:[],visible:!0,checkbox:topic.querySelector(IDENTIFIERS_CHECKBOX)};elements.forEach((element=>{const title=element.querySelector(IDENTIFIERS_TITLE);if(title){const cmObj={title:title.textContent.toLowerCase(),elem:element,visible:!0,checkbox:element.querySelector(IDENTIFIERS_CHECKBOX)};topicObj.cms.push(cmObj)}})),allCmsPerTopic.push(topicObj)}))}}}));

//# sourceMappingURL=search.min.js.map